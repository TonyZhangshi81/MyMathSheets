<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="AppData/Work/Content/image/favicon.ico">
    <link href="AppData/Work/Content/bootstrap.min.css" rel="stylesheet" charset="utf-8">
    <link href="AppData/Work/Content/jquery-ui.css" rel="stylesheet" charset="utf-8">
    <link href="AppData/Work/Content/icon.css" rel="stylesheet" charset="utf-8">
    <link href="AppData/Work/Content/font-awesome.min.css" rel="stylesheet" charset="utf-8">
    <link href="AppData/Work/Content/Shake.css" rel="stylesheet" charset="utf-8">

    <script src="AppData/Work/Scripts/jquery-3.3.1.min.js" charset="utf-8"></script>
    <script src="AppData/Work/Scripts/jquery.linq.min.js" charset="utf-8"></script>
    <script src="AppData/Work/Scripts/jquery.base64.js" charset="utf-8"></script>
    <script src="AppData/Work/Scripts/jquery.PrintArea.js" charset="utf-8"></script>
    <script src="AppData/Work/Scripts/jquery-ui.js" charset="utf-8"></script>
    <script src="AppData/Work/Scripts/umd/popper.js" charset="utf-8"></script>
    <script src="AppData/Work/Scripts/bootstrap.min.js" charset="utf-8"></script>
    <script src="AppData/Work/Scripts/store.legacy.min.js" charset="utf-8"></script>
    <script src="AppData/Work/Scripts/json2.min.js" charset="utf-8"></script>
    <script src="AppData/Work/Scripts/snap/snap.svg-min.js"></script>
    <script src="AppData/Work/Scripts/jquery.rating-stars.min.js"></script>
    <script src="AppData/Work/Scripts/jquery.easing.1.3.js"></script>
    <script src="AppData/Work/Scripts/Ext/MathSheets.System.js" charset="utf-8"></script>

    <title>一起数学</title>
    <script type="text/javascript">

        $(function () {
            topicManagement();

            $("#btnReady").click(function () { return btnReadyClick(); });
        });

        btnReadyClick = function () {

            // 輸入參數
            var jsonObj = getTopicSettingJson();
            // 站點信息
            var endpointAddress = "http://localhost/MyMathSheetsService/Service.svc";
            // 接口名稱
            var url = endpointAddress + "/MarkFormula";

            $.ajax({
                url: url,
                type: "POST",
                contentType: "application/json",
                data: JSON.stringify(jsonObj),
                cache: false,
                dataType: "text",

                beforeSend: function () {
                    $("<div class=\"datagrid-mask\"></div>").html("Please Wait...").appendTo("body");
                },
                complete: function (data) {
                    setTimeout(function () {
                        $('.datagrid-mask').remove();
                    }, 400);
                },
                success: function (result) {
                    console.log(result);
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    console.log("status:" + XMLHttpRequest.status + " readyState:" + XMLHttpRequest.readyState + " textStatus:" + textStatus);
                }
            });

            return false;
        }

        topicManagement = function () {
            $.ajax({
                url: "Config/TopicManagement.json", // 讀取題型文件
                type: "GET",                        // 請求方式為get
                dataType: "json",                   // 返回數據格式為json
                success: function (data) {
                    // 遍歷返回的數據DATA
                    $.each(data, function (i, item) {
                        // 下拉列表框初期化
                        init(item.id, item.name);
                        // 題型編號列表框參數綁定
                        setTopicModule(item.id, item.name);
                    })
                }
            })
        }

        // 題型編號列表框參數綁定
        setTopicModule = function (id, name) {
            $.ajax({
                url: "Config/" + id + ".json",      // 讀取題型參數配置文件
                type: "GET",                        // 請求方式為get
                dataType: "json",                   // 返回數據格式為json
                success: function (data) {
                    // 題型編號下拉列表框
                    $ddl = $("#ddl" + id);
                    // 遍歷返回的數據DATA
                    $.each(data, function (i, item) {
                        var option = "<option value='" + item.Identifier + "'>" + item.Identifier + "</option>";
                        $ddl.append(option);
                    })
                }
            })
        }

        init = function (id, name) {
            // 題型名稱
            $span = $("#span" + id);
            $span.text(name);
            // 題型編號下拉列表框
            $ddl = $("#ddl" + id);
            $ddl.html("<option value=''>請選擇</option>");
        }

        getTopicSettingJson = function () {

            var list = new Array();
            $("select").each(function () {
                if ($(this).val() != "") {
                    var topicManagement = {
                        "Id": $(this).attr("id").substring(3),
                        "Number": $(this).val()
                    };
                    list.push(topicManagement);
                }
            });
            return list;
        }
    </script>
</head>
<body>
    <div class="container">
        <div class="row">
            <div class="col-md-4 form-inline">
                <h5><span id="spanArithmeticOperations"></span></h5>
                <select id="ddlArithmeticOperations"></select>
            </div>
            <div class="col-md-4 form-inline">
                <h5><span id="spanCombinatorialEquation"></span></h5>
                <select id="ddlCombinatorialEquation"></select>
            </div>
            <div class="col-md-4 form-inline">
                <h5><span id="spanComputingConnection"></span></h5>
                <select id="ddlComputingConnection"></select>
            </div>
        </div>

        <div class="clearfix" style="margin-bottom: 10px;"></div>

        <div class="row">
            <div class="col-md-4 form-inline">
                <h5><span id="spanCurrencyLinkage"></span></h5>
                <select id="ddlCurrencyLinkage"></select>
            </div>
            <div class="col-md-4 form-inline">
                <h5><span id="spanCurrencyOperation"></span></h5>
                <select id="ddlCurrencyOperation"></select>
            </div>
            <div class="col-md-4 form-inline">
                <h5><span id="spanEqualityComparison"></span></h5>
                <select id="ddlEqualityComparison"></select>
            </div>
        </div>

        <div class="clearfix" style="margin-bottom: 10px;"></div>
        <div class="row">
            <div class="col-md-4 form-inline">
                <h5><span id="spanEqualityLinkage"></span></h5>
                <select id="ddlEqualityLinkage"></select>
            </div>
            <div class="col-md-4 form-inline">
                <h5><span id="spanMathWordProblems"></span></h5>
                <select id="ddlMathWordProblems"></select>
            </div>
            <div class="col-md-4 form-inline">
                <h5><span id="spanFruitsLinkage"></span></h5>
                <select id="ddlFruitsLinkage"></select>
            </div>
        </div>

        <div class="clearfix" style="margin-bottom: 10px;"></div>
        <div class="row">
            <div class="col-md-4 form-inline">
                <h5><span id="spanFindNearestNumber"></span></h5>
                <select id="ddlFindNearestNumber"></select>
            </div>
            <div class="col-md-4 form-inline">
                <h5><span id="spanFindTheLaw"></span></h5>
                <select id="ddlFindTheLaw"></select>
            </div>
            <div class="col-md-4 form-inline">
                <h5><span id="spanGapFillingProblems"></span></h5>
                <select id="ddlGapFillingProblems"></select>
            </div>
        </div>

        <div class="clearfix" style="margin-bottom: 10px;"></div>
        <div class="row">
            <div class="col-md-4 form-inline">
                <h5><span id="spanHowMuchMore"></span></h5>
                <select id="ddlHowMuchMore"></select>
            </div>
            <div class="col-md-4 form-inline">
                <h5><span id="spanLearnCurrency"></span></h5>
                <select id="ddlLearnCurrency"></select>
            </div>
            <div class="col-md-4 form-inline">
                <h5><span id="spanLearnLengthUnit"></span></h5>
                <select id="ddlLearnLengthUnit"></select>
            </div>
        </div>

        <div class="clearfix" style="margin-bottom: 10px;"></div>
        <div class="row">
            <div class="col-md-4 form-inline">
                <h5><span id="spanNumericSorting"></span></h5>
                <select id="ddlNumericSorting"></select>
            </div>
            <div class="col-md-4 form-inline">
                <h5><span id="spanSchoolClock"></span></h5>
                <select id="ddlSchoolClock"></select>
            </div>
            <div class="col-md-4 form-inline">
                <h5><span id="spanScoreGoal"></span></h5>
                <select id="ddlScoreGoal"></select>
            </div>
        </div>

        <div class="clearfix" style="margin-bottom: 10px;"></div>
        <div class="row">
            <div class="col-md-4 form-inline">
                <h5><span id="spanTimeCalculation"></span></h5>
                <select id="ddlTimeCalculation"></select>
            </div>
            <div class="col-md-4 form-inline">
                <h5><span id="spanMathUpright"></span></h5>
                <select id="ddlMathUpright"></select>
            </div>
            <div class="col-md-4 form-inline">
                <h5><span id="spanCleverCalculation"></span></h5>
                <select id="ddlCleverCalculation"></select>
            </div>
        </div>

        <div class="clearfix" style="margin-bottom: 10px;"></div>
        <div class="row">
            <div class="col-md-4 form-inline">
                <h5><span id="spanRecursionEquation"></span></h5>
                <select id="ddlRecursionEquation"></select>
            </div>
        </div>
    </div>
    <div class="clearfix" style="margin-bottom: 30px;"></div>
    <div class="panel-footer">
        <div class="row">
            <div class="col-md-12 col-md-offset-3">
                <p class="text-center">
                    <button id="btnReady" type="button" class="btn btn-lg btn-success">出題</button>
                </p>
            </div>
        </div>
    </div>
</body>
</html>